marker = list(opacity = .5, size=4))
p
p <- plot_ly(data=d) %>%
# the scatter plot of the data points
add_trace(x=d$jitterx, y=d$jittery, z=d$jitterz,
color=d$LithicArtifactClass,
type="scatter3d", mode="markers",
colors = "Set1",
hoverinfo = "text",
hovertext=paste(d$Munsell, d$LithicArtifactClass),
jitter = 0.7,
marker = list(opacity = .5, size=4))
p
ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=d$EvidencePostDepBurning),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black")
library(here)
library(readxl)
library(stringr)
library(plotly)
library(vegan)
#Test the function.
#Load function.
source("Munsell color quantifier.R")
#Read in data
d<-read_xlsx("LBJ attribute data.xlsx")
d2<-read_xlsx("BX232 artifact colors.xlsx")
# Add bx232 data here
d<-d[grep("SITE|Munsell|Mass", names(d))]
d2<-d2[grep("SITE|Munsell|Mass", names(d2))]
d<-rbind(d, d2)
library(here)
library(readxl)
library(stringr)
library(plotly)
library(vegan)
#Test the function.
#Load function.
source("Munsell color quantifier.R")
#Read in data
d<-read_xlsx("LBJ attribute data.xlsx")
d2<-read_xlsx("BX232 artifact colors.xlsx")
# Add bx232 data here
d<-d[grep("SITE|Munsell|Mass", names(d))]
d2<-d2[grep("SITE|Munsell|Mass", names(d2))]
d<-rbind(d, d2)
# Test the function
color<-paste("7.5yr7/2")
hue<-str_replace(color, "(.)[/](.)", "")
chroma<-as.numeric(str_match(color, "(.)[/](.)"))[2]
value<-as.numeric(str_match(color, "(.)[/](.)"))[3]
munsell.converter(hue,value, chroma)
## Apply function to every artifact in the dataset.
for(i in 1:length(d$Munsell)){
color<-d$Munsell[i]
hue<-str_replace(color, "(.)[/](.)", "")
chroma<-as.numeric(str_match(color, "(.)[/](.)"))[2]
value<-as.numeric(str_match(color, "(.)[/](.)"))[3]
output<-munsell.converter(hue, value,chroma)
d$colorx[i]<-as.numeric(output[1])
d$colory[i]<-as.numeric(output[2])
d$colorz[i]<-as.numeric(output[3])
}
jitterfy<-function(x){
return(rnorm(1,x, .1))
}
for(i in 1:length(d$colorx)){d$jitterx[i]<-jitterfy(d$colorx[i])}
for(i in 1:length(d$colory)){d$jittery[i]<-jitterfy(d$colory[i])}
for(i in 1:length(d$colorz)){d$jitterz[i]<-jitterfy(d$colorz[i])}
p <- plot_ly(data=d) %>%
# the scatter plot of the data points
add_trace(x=d$jitterx, y=d$jittery, z=d$jitterz,
color=d$LithicArtifactClass,
type="scatter3d", mode="markers",
colors = "Set1",
hoverinfo = "text",
hovertext=paste(d$Munsell, d$LithicArtifactClass),
jitter = 0.7,
marker = list(opacity = .5, size=4))
ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=d$SITE),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black")
p<-ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=d$SITE),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black")
p + geom_polygon(data = d,
aes(fill = SITE,
colour = SITE),
alpha = 0.3,
show.legend = FALSE)
p<-ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=SITE),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black")
p
p + geom_polygon(data = d,
aes(fill = SITE,
colour = SITE),
alpha = 0.3,
show.legend = FALSE)
p + geom_polygon(data = d,
aes(x=colorx, y=colory,
fill = SITE,
colour = SITE),
alpha = 0.3,
show.legend = FALSE)
p
p + geom_polygon(data = d,
aes(x=colorx, y=colory,
fill = SITE,
colour = SITE),
alpha = 0.3,
show.legend = FALSE)
library(dplyr)
d %>%
group_by(SITE) %>%
mutate(hull = 1:n(), hull = factor(hull, chull(colorx, colory))) %>%
arrange(hull)
d = na.omit(d)%>%
group_by(SITE) %>%
mutate(hull = 1:n(), hull = factor(hull, chull(colorx, colory))) %>%
arrange(hull)
p<-ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=SITE),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black")
p + geom_polygon(data = filter(d, !is.na(hull)), alpha = 0.5))
p + geom_polygon(data = filter(d, !is.na(hull)), alpha = 0.5)
p<-ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=SITE),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_polygon(data = filter(d, !is.na(hull)), alpha = 0.5)
p
find_hull <- function(x) x[chull(x[,1], x[,2]), ]
find_hull <- function(x) x[chull(x$colorx, x$colory), ]
find_hull
find_hull <- function(x) x[chull(x$colorx, x$colory), ]
hulls <- ddply(d, "SITE", find_hull)
library(dplyr)
find_hull <- function(x) x[chull(x$colorx, x$colory), ]
hulls <- ddply(d, "SITE", find_hull)
library(plyr)
library(plyr)
find_hull <- function(x) x[chull(x$colorx, x$colory), ]
hulls <- ddply(d, "SITE", find_hull)
hulls
p<-ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=hull),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_polygon(data = filter(d, !is.na(hull)), alpha = 0.5)
p<-ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=SITE),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_polygon(data = hulls, aes(x=colorx, y=colory, fill=SITES), alpha = 0.5)
ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=SITE),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_polygon(data = hulls, aes(x=colorx, y=colory, fill=SITES), alpha = 0.5)
ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=SITE),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_polygon(data = hulls, aes(x=colorx, y=colory, fill=SITE), alpha = 0.5)
hulls
ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=SITE),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_polygon(data = hulls, aes(x=colorx, y=colory, fill=SITE), alpha = 0.5)
ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=SITE),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_polygon(data = hulls, aes(x=colorx, y=colorz, fill=SITE), alpha = 0.5)
length(hulls$SITE)
hulls
hulls
find_hull <- function(x) x[chull(x$colorx, x$colorz), ]
hulls <- ddply(d, "SITE", find_hull)
ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=SITE),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_polygon(data = hulls, aes(x=colorx, y=colorz, fill=SITE), alpha = 0.5)
library(here)
library(readxl)
library(stringr)
library(dplyr)
library(plyr)
library(plotly)
library(vegan)
#Test the function.
#Load function.
source("Munsell color quantifier.R")
#Read in data
d<-read_xlsx("LBJ attribute data.xlsx")
d2<-read_xlsx("BX232 artifact colors.xlsx")
# Add bx232 data here
#d<-d[grep("SITE|Munsell|Mass", names(d))]
#d2<-d2[grep("SITE|Munsell|Mass", names(d2))]
#d<-rbind(d, d2)
## Apply function to every artifact in the dataset.
for(i in 1:length(d$Munsell)){
color<-d$Munsell[i]
hue<-str_replace(color, "(.)[/](.)", "")
chroma<-as.numeric(str_match(color, "(.)[/](.)"))[2]
value<-as.numeric(str_match(color, "(.)[/](.)"))[3]
output<-munsell.converter(hue, value,chroma)
d$colorx[i]<-as.numeric(output[1])
d$colory[i]<-as.numeric(output[2])
d$colorz[i]<-as.numeric(output[3])
}
jitterfy<-function(x){
return(rnorm(1,x, .1))
}
for(i in 1:length(d$colorx)){d$jitterx[i]<-jitterfy(d$colorx[i])}
for(i in 1:length(d$colory)){d$jittery[i]<-jitterfy(d$colory[i])}
for(i in 1:length(d$colorz)){d$jitterz[i]<-jitterfy(d$colorz[i])}
p <- plot_ly(data=d) %>%
# the scatter plot of the data points
add_trace(x=d$jitterx, y=d$jittery, z=d$jitterz,
color=d$LithicArtifactClass,
type="scatter3d", mode="markers",
colors = "Set1",
hoverinfo = "text",
hovertext=paste(d$Munsell, d$LithicArtifactClass),
jitter = 0.7,
marker = list(opacity = .5, size=4))
p
find_hull <- function(x) x[chull(x$colorx, x$colorz), ]
hulls <- ddply(d, "EvidencePostDepBurning", find_hull)
d
d$colorx
find_hull <- function(x) x[chull(x$colorx, x$colorz), ]
hulls <- ddply(d, "EvidencePostDepBurning", find_hull)
ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=EvidencePostDepBurning),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_polygon(data = hulls, aes(x=colorx, y=colorz, fill=EvidencePostDepBurning), alpha = 0.5)
library(here)
library(readxl)
library(stringr)
library(dplyr)
library(plyr)
library(plotly)
library(vegan)
#Test the function.
#Load function.
source("Munsell color quantifier.R")
#Read in data
d<-read_xlsx("LBJ attribute data.xlsx")
d2<-read_xlsx("BX232 artifact colors.xlsx")
# Add bx232 data here
#d<-d[grep("SITE|Munsell|Mass", names(d))]
#d2<-d2[grep("SITE|Munsell|Mass", names(d2))]
#d<-rbind(d, d2)
## Apply function to every artifact in the dataset.
for(i in 1:length(d$Munsell)){
color<-d$Munsell[i]
hue<-str_replace(color, "(.)[/](.)", "")
chroma<-as.numeric(str_match(color, "(.)[/](.)"))[2]
value<-as.numeric(str_match(color, "(.)[/](.)"))[3]
output<-munsell.converter(hue, value,chroma)
d$colorx[i]<-as.numeric(output[1])
d$colory[i]<-as.numeric(output[2])
d$colorz[i]<-as.numeric(output[3])
}
jitterfy<-function(x){
return(rnorm(1,x, .1))
}
for(i in 1:length(d$colorx)){d$jitterx[i]<-jitterfy(d$colorx[i])}
for(i in 1:length(d$colory)){d$jittery[i]<-jitterfy(d$colory[i])}
for(i in 1:length(d$colorz)){d$jitterz[i]<-jitterfy(d$colorz[i])}
p <- plot_ly(data=d) %>%
# the scatter plot of the data points
add_trace(x=d$jitterx, y=d$jittery, z=d$jitterz,
color=d$LithicArtifactClass,
type="scatter3d", mode="markers",
colors = "Set1",
hoverinfo = "text",
hovertext=paste(d$Munsell, d$LithicArtifactClass),
jitter = 0.7,
marker = list(opacity = .5, size=4))
p
find_hull <- function(x) x[chull(x$colorx, x$colorz), ]
hulls <- ddply(d, "EvidencePostDepBurning", find_hull)
sum(d$colorx)
sum(d$colory)
sum(d$colory,na.rm=TRUE)
ggplot(data=d) +
geom_jitter(aes(x=colorx, y=colorz, fill=EvidencePostDepBurning),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_polygon(data = hulls, aes(x=colorx, y=colorz, fill=EvidencePostDepBurning), alpha = 0.5)
library(here)
library(readxl)
library(stringr)
library(dplyr)
library(plyr)
library(plotly)
library(vegan)
#Test the function.
#Load function.
source("Munsell color quantifier.R")
#Read in data
d<-read_xlsx("LBJ attribute data.xlsx")
d2<-read_xlsx("BX232 artifact colors.xlsx")
# Add bx232 data here
#d<-d[grep("SITE|Munsell|Mass", names(d))]
#d2<-d2[grep("SITE|Munsell|Mass", names(d2))]
#d<-rbind(d, d2)
## Apply function to every artifact in the dataset.
for(i in 1:length(d$Munsell)){
color<-d$Munsell[i]
hue<-str_replace(color, "(.)[/](.)", "")
chroma<-as.numeric(str_match(color, "(.)[/](.)"))[2]
value<-as.numeric(str_match(color, "(.)[/](.)"))[3]
output<-munsell.converter(hue, value,chroma)
d$colorx[i]<-as.numeric(output[1])
d$colory[i]<-as.numeric(output[2])
d$colorz[i]<-as.numeric(output[3])
}
jitterfy<-function(x){
return(rnorm(1,x, .1))
}
for(i in 1:length(d$colorx)){d$jitterx[i]<-jitterfy(d$colorx[i])}
for(i in 1:length(d$colory)){d$jittery[i]<-jitterfy(d$colory[i])}
for(i in 1:length(d$colorz)){d$jitterz[i]<-jitterfy(d$colorz[i])}
p <- plot_ly(data=d) %>%
# the scatter plot of the data points
add_trace(x=d$jitterx, y=d$jittery, z=d$jitterz,
color=d$LithicArtifactClass,
type="scatter3d", mode="markers",
colors = "Set1",
hoverinfo = "text",
hovertext=paste(d$Munsell, d$LithicArtifactClass),
jitter = 0.7,
marker = list(opacity = .5, size=4))
p
test<-d[which(d$colorz>0),]
pc <- princomp(~ colorx + colory + colorz,
data = test, na.action = na.exclude, cor = TRUE)
scores<-as.data.frame(pc$scores)
d$Comp.1[which(d$colorz>0)]<-scores$Comp.1
d$Comp.2[which(d$colorz>0)]<-scores$Comp.2
d$Comp.3[which(d$colorz>0)]<-scores$Comp.3
pc$loadings
ggplot(data=d) +
geom_jitter(aes(x=Comp.1, y=Comp.2, fill=d$EvidencePostDepBurning),
width=.1, height=.1,
alpha=.5, shape=21,size=2,
color="black")
ggplot(data=d) +
geom_jitter(aes(x=Comp.1, y=Comp.2, fill=d$EvidencePostDepBurning),
width=.1, height=.1,
alpha=.5, shape=21,size=2,
color="black")
find_hull <- function(x) x[chull(x$colorx, x$colorz), ]
hulls <- ddply(d, "EvidencePostDepBurning", find_hull)
find_hull <- function(x) x[chull(x$colorx, x$colorz), ]
test<-d[which(d$colorz>0),]
hulls <- ddply(test, "EvidencePostDepBurning", find_hull)
ggplot(data=test) +
geom_jitter(aes(x=colorx, y=colorz, fill=EvidencePostDepBurning),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_polygon(data = hulls, aes(x=colorx, y=colorz, fill=EvidencePostDepBurning), alpha = 0.5)
install.packages("ggalt")
library(ggalt)
ggplot(data=test) +
geom_jitter(aes(x=colorx, y=colorz, fill=EvidencePostDepBurning),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_bag(prop=.95)
library(ggalt)
source("Convex hull function.R")
ggplot(data=test) +
geom_jitter(aes(x=colorx, y=colorz, fill=EvidencePostDepBurning),
width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_bag(prop=.95)
ggplot(data=test, aes(x=colorx, y=colorz, fill=EvidencePostDepBurning)) +
geom_jitter(width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_bag(prop=.95)
ggplot(data=test, aes(x=colorx, y=colory, fill=EvidencePostDepBurning)) +
geom_jitter(width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_bag(prop=.95)
ggplot(data=test, aes(x=colorz, y=colory, fill=EvidencePostDepBurning)) +
geom_jitter(width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_bag(prop=.95)
ggplot(data=test, aes(x=colorx, y=colorz, fill=EvidencePostDepBurning)) +
geom_jitter(width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_bag(prop=.95)
test$LithicArtifactClass
ggplot(data=test, aes(x=colorx, y=colorz, fill=LithicArtifactClass)) +
geom_jitter(width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_bag(prop=.95)
ggplot(data=test, aes(x=colorx, y=colorz, fill=SITE)) +
geom_jitter(width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_bag(prop=.95)
ggplot(data=test, aes(x=colorx, y=colorz, fill=SITE)) +
geom_jitter(width=.1, height=.1,
alpha=.8, shape=21,size=2,
color="black") +
geom_bag(prop=.9)
library(here)
library(readxl)
library(ggplot2)
library(vegan)
setwd(here::here())
d<-read_xlsx("LBJ attribute data.xlsx", sheet=1)
source("Clean Data.R")
data<-clean.data(d)
library(here)
library(readxl)
library(ggplot2)
library(vegan)
setwd(here::here())
d<-read_xlsx("LBJ attribute data.xlsx", sheet=1)
source("Clean Data.R")
source("Munsell color quantifier.R")
data<-clean.data(d)
data<-munsell.converter(d)
data
data<-munsell.converter(d$Munsell)
library(here)
library(readxl)
library(ggplot2)
library(vegan)
setwd(here::here())
d<-read_xlsx("LBJ attribute data.xlsx", sheet=1)
source("Clean Data.R")
source("Munsell color quantifier.R")
d<-clean.data(d)
for(i in 1:length(d$Munsell)){
color<-d$Munsell[i]
hue<-str_replace(color, "(.)[/](.)", "")
chroma<-as.numeric(str_match(color, "(.)[/](.)"))[2]
value<-as.numeric(str_match(color, "(.)[/](.)"))[3]
output<-munsell.converter(hue, value,chroma)
d$colorx[i]<-as.numeric(output[1])
d$colory[i]<-as.numeric(output[2])
d$colorz[i]<-as.numeric(output[3])
}
library(here)
library(readxl)
library(ggplot2)
library(vegan)
library(stringr)
library(here)
library(readxl)
library(ggplot2)
library(vegan)
library(stringr)
setwd(here::here())
d<-read_xlsx("LBJ attribute data.xlsx", sheet=1)
source("Clean Data.R")
source("Munsell color quantifier.R")
d<-clean.data(d)
for(i in 1:length(d$Munsell)){
color<-d$Munsell[i]
hue<-str_replace(color, "(.)[/](.)", "")
chroma<-as.numeric(str_match(color, "(.)[/](.)"))[2]
value<-as.numeric(str_match(color, "(.)[/](.)"))[3]
output<-munsell.converter(hue, value,chroma)
d$colorx[i]<-as.numeric(output[1])
d$colory[i]<-as.numeric(output[2])
d$colorz[i]<-as.numeric(output[3])
}
GL317<-d[which(d$SITE=="41GL317"),]
ggplot(data=GL317, aes(x=Mass,y=lvl)) +
stat_summary(fun = sum, na.rm = TRUE, color = 'black', geom ='line', size=1.2) +
stat_summary(fun = sum, na.rm = TRUE, color = 'black', geom ='point', size=2) +
scale_y_discrete(limits = rev(levels(data$lvl)))+ facet_wrap(~context)
